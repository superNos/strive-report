<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>è¿™ä¸€æœˆï¼Œæˆ‘æ²¡æœ‰æ”¾å¼ƒ</title>
    <style>
        /* --- 1. åŸºç¡€æ ·å¼ä¸é‡ç½® --- */
        :root {
            --bg: #050507;
            --card: #1c1c1e;
            --primary: #0A84FF; /* iOS Blue */
            --accent: #BF5AF2;  /* iOS Purple */
            --gold: #FFD60A;
            --text: #FFFFFF;
            --text-sec: #8E8E93;
            --font: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: var(--font);
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ç§»åŠ¨ç«¯å®¹å™¨æ¨¡æ‹Ÿ */
        #app {
            width: 100%;
            max-width: 450px;
            height: 100%;
            position: relative;
            background: radial-gradient(circle at top right, #1a1a3a 0%, transparent 50%),
                        radial-gradient(circle at bottom left, #1a0f0a 0%, transparent 50%);
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* --- 2. é¡µé¢åˆ‡æ¢ç³»ç»Ÿ --- */
        .page {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            padding: 24px;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95) translateY(20px);
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 1;
        }

        .page.active {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1) translateY(0);
            z-index: 10;
        }

        /* --- 3. ç»„ä»¶æ ·å¼ --- */
        
        /* æŒ‰é’® */
        .btn-main {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none; color: #fff;
            padding: 18px 0; width: 100%;
            border-radius: 30px;
            font-size: 18px; font-weight: 600;
            box-shadow: 0 10px 20px rgba(10, 132, 255, 0.3);
            margin-top: auto; cursor: pointer;
            transition: transform 0.1s;
        }
        .btn-main:active { transform: scale(0.98); }

        /* å¯åŠ¨é¡µ */
        .intro-visual {
            flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center;
            text-align: center;
        }
        .particles {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0; z-index: -1;
            background-image: radial-gradient(#ffffff 1px, transparent 1px);
            background-size: 30px 30px; opacity: 0.1;
        }
        .title-large { font-size: 32px; font-weight: 800; letter-spacing: 1px; margin-bottom: 10px; }
        .subtitle { font-size: 16px; color: var(--text-sec); line-height: 1.5; opacity: 0.8; }

        /* ç”¨æˆ·é€‰æ‹©é¡µ */
        .user-scroll {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;
            overflow-y: auto; padding-bottom: 80px; margin-top: 20px;
        }
        .user-card {
            background: rgba(255,255,255,0.08);
            border-radius: 16px; padding: 20px 15px;
            text-align: center; border: 1px solid rgba(255,255,255,0.05);
            transition: all 0.3s; cursor: pointer;
        }
        .user-card:active { background: rgba(255,255,255,0.15); }
        .u-avatar { font-size: 40px; margin-bottom: 10px; display: block; }
        .u-name { font-size: 16px; font-weight: 600; margin-bottom: 5px; }
        .u-label { font-size: 10px; color: var(--primary); background: rgba(10, 132, 255, 0.15); padding: 2px 6px; border-radius: 4px; }

        /* æ•°æ®æ¦‚è§ˆé¡µ */
        .data-hero { text-align: center; margin: 30px 0; }
        .hero-num { font-size: 64px; font-weight: 800; background: -webkit-linear-gradient(#fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero-label { font-size: 14px; color: var(--text-sec); letter-spacing: 2px; text-transform: uppercase; }
        .stat-grid { display: flex; justify-content: space-around; margin-bottom: 30px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }
        .stat-item div:first-child { font-size: 24px; font-weight: 700; margin-bottom: 5px; }
        .stat-item div:last-child { font-size: 12px; color: var(--text-sec); }

        /* æ—¶é—´è½´é¡µ */
        .timeline-container { flex: 1; overflow-y: auto; margin-top: 10px; padding-right: 5px; }
        .t-node { display: flex; margin-bottom: 25px; opacity: 0; transform: translateY(20px); animation: fadeInUp 0.5s forwards; }
        .t-date { width: 50px; font-size: 12px; color: var(--text-sec); text-align: right; padding-top: 4px; font-family: monospace; }
        .t-line-box { width: 30px; position: relative; display: flex; justify-content: center; }
        .t-line { width: 2px; background: rgba(255,255,255,0.1); height: 100%; position: absolute; top: 10px; }
        .t-dot { width: 10px; height: 10px; background: var(--primary); border-radius: 50%; z-index: 2; margin-top: 6px; box-shadow: 0 0 10px var(--primary); }
        .t-content { flex: 1; background: var(--card); padding: 15px; border-radius: 12px; position: relative; }
        .t-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-right: 5px; vertical-align: middle; }
        .tag-sport { background: rgba(255, 59, 48, 0.2); color: #ff3b30; }
        .tag-study { background: rgba(48, 209, 88, 0.2); color: #30d158; }
        .t-text { font-size: 14px; line-height: 1.4; margin-top: 5px; display: block;}
        .t-dur { position: absolute; top: 12px; right: 12px; font-size: 12px; font-weight: 700; color: var(--text-sec); }
        .badge-high { position: absolute; top: -10px; right: -5px; font-size: 20px; transform: rotate(15deg); }

        /* ç»“æœæµ·æŠ¥é¡µ */
        .poster-frame {
            background: #fff; color: #000; border-radius: 20px; padding: 30px 20px;
            margin: 20px 0; transform: rotate(-1deg);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            text-align: center;
            animation: float 6s ease-in-out infinite;
        }
        .keyword-stamp {
            font-size: 42px; font-weight: 900; color: var(--accent);
            border: 4px solid var(--accent); display: inline-block;
            padding: 5px 15px; transform: rotate(-5deg); margin: 15px 0;
            opacity: 0.8;
        }

        /* åŠ¨ç”» Keyframes */
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0%, 100% { transform: rotate(-1deg) translateY(0); } 50% { transform: rotate(-1deg) translateY(-10px); } }
        
        /* è¾…åŠ©ç±» */
        .hidden { display: none; }
        .nav-bar { display: flex; gap: 10px; width: 100%; padding-bottom: 20px; }
        .btn-sub { flex: 1; background: rgba(255,255,255,0.1); border: none; color: #fff; padding: 15px; border-radius: 20px; font-weight: 600; }
    </style>
</head>
<body>

<div id="app">
    <!-- é¡µé¢ 1: å¯åŠ¨é¡µ -->
    <div class="page active" id="p1">
        <div class="particles"></div>
        <div class="intro-visual">
            <div style="font-size:60px; margin-bottom:20px; text-shadow: 0 0 30px rgba(10,132,255,0.6);">â³</div>
            <div class="title-large">è‡ªå¾‹æ—¶å…‰æœº</div>
            <p class="subtitle">æœ‰äººé€‰æ‹©æ”¾çºµï¼Œæœ‰äººé€‰æ‹©åšæŒã€‚<br>è¿™ä¸æ˜¯æ•°æ®ï¼Œè¿™æ˜¯ä¸è‡ªå·±å¯¹è¯çš„30å¤©ã€‚</p>
        </div>
        <button class="btn-main" onclick="router.go('p2')">å¯åŠ¨æ—¶å…‰æœº</button>
    </div>

    <!-- é¡µé¢ 2: äººç‰©é€‰æ‹© -->
    <div class="page" id="p2">
        <div class="title-large" style="font-size: 24px;">ç¡®è®¤ä½ çš„èº«ä»½</div>
        <p class="subtitle">ç³»ç»Ÿè¯†åˆ«åˆ° 5 ä½åšæŒè€…çš„é¢‘ç‡ä¿¡å·</p>
        <div class="user-scroll" id="userListContainer">
            <!-- JS åŠ¨æ€ç”Ÿæˆç”¨æˆ·å¡ç‰‡ -->
        </div>
    </div>

    <!-- é¡µé¢ 3: ä»ªè¡¨ç›˜ -->
    <div class="page" id="p3">
        <div style="text-align: center; margin-top: 20px;">
            <div id="dashAvatar" style="font-size: 50px; margin-bottom: 10px;"></div>
            <h2 id="dashName">User</h2>
        </div>
        
        <div class="data-hero">
            <div class="hero-label">11æœˆç´¯è®¡æŠ•å…¥</div>
            <div class="hero-num" id="dashTotalTime">0</div>
            <div class="hero-label">åˆ†é’Ÿ</div>
        </div>

        <div class="stat-grid">
            <div class="stat-item">
                <div id="dashDays">0</div>
                <div>åšæŒå¤©æ•°</div>
            </div>
            <div class="stat-item">
                <div id="dashStreak">0</div>
                <div>æœ€é•¿è¿æ‰“</div>
            </div>
            <div class="stat-item">
                <div id="dashType">å­¦ä¹ </div>
                <div>æ ¸å¿ƒé¢†åŸŸ</div>
            </div>
        </div>

        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
            <p id="dashQuote" style="margin:0; font-size:14px; line-height:1.5; color:#ccc; font-style: italic;">
                "æ–‡æ¡ˆåŠ è½½ä¸­..."
            </p>
        </div>

        <div class="nav-bar" style="margin-top:auto">
            <button class="btn-sub" onclick="router.back()">è¿”å›</button>
            <button class="btn-main" style="flex:2; margin-top:0" onclick="router.go('p4')">æŸ¥çœ‹è¶³è¿¹</button>
        </div>
    </div>

    <!-- é¡µé¢ 4: æ—¶é—´è½´ -->
    <div class="page" id="p4">
        <div class="title-large" style="font-size: 24px;">åšæŒå›æ”¾</div>
        <p class="subtitle">æ¯ä¸€æ¡è®°å½•ï¼Œéƒ½æ˜¯ä½ ç•™ä¸‹çš„è„šå°</p>
        
        <div class="timeline-container" id="timelineList">
            <!-- JS åŠ¨æ€ç”Ÿæˆæ—¶é—´è½´ -->
        </div>

        <div class="nav-bar" style="padding-top: 15px;">
            <button class="btn-sub" onclick="router.back()">æ¦‚è§ˆ</button>
            <button class="btn-main" style="flex:2; margin-top:0" onclick="router.go('p5')">ç”Ÿæˆæ€»ç»“</button>
        </div>
    </div>

    <!-- é¡µé¢ 5: ç»“æœæµ·æŠ¥ -->
    <div class="page" id="p5">
        <div style="flex:1; display: flex; align-items: center; justify-content: center;">
            <div class="poster-frame">
                <div style="font-size: 12px; color: #666; letter-spacing: 2px; margin-bottom: 10px;">NOVEMBER 2025 REPORT</div>
                <div id="posterAvatar" style="font-size: 60px; margin-bottom: 10px;"></div>
                <h2 style="margin:0"><span id="posterName">User</span> çš„è‡ªå¾‹æ¡£æ¡ˆ</h2>
                
                <div class="keyword-stamp" id="posterKeyword">è‡ªå¾‹ç‹è€…</div>
                
                <p id="posterDesc" style="font-size: 14px; color: #444; line-height: 1.6; margin: 20px 0; text-align: justify;">
                    æè¿°æ–‡æ¡ˆ...
                </p>

                <div style="border-top: 1px dashed #ccc; padding-top: 15px; display: flex; justify-content: space-between;">
                    <div style="text-align: left;">
                        <div style="font-size: 12px; color: #888;">æ€»æ—¶é•¿</div>
                        <div style="font-weight: 800; font-size: 18px;"><span id="posterTime">0</span>h</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 12px; color: #888;">é«˜å…‰æ—¶åˆ»</div>
                        <div style="font-weight: 800; font-size: 18px;" id="posterHighlight">0m</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; background: #000; color: #fff; padding: 10px; font-size: 12px; border-radius: 8px;">
                    ã€Šè¿™ä¸€æœˆï¼Œæˆ‘æ²¡æœ‰æ”¾å¼ƒã€‹
                </div>
            </div>
        </div>
        <button class="btn-main" onclick="location.reload()">å†æ¬¡å¯åŠ¨æ—¶å…‰æœº</button>
    </div>
</div>

<script>
    // ========================================
    // 1. æ•°æ®åº“æ„å»º (åŸºäº "æ¯æ—¥è‡ªå¾‹æ‰“å¡.csv")
    // ========================================
    const rawData = [
        // æ ¼å¼: [æ—¥æœŸ, æäº¤è€…, ç±»å‹, æ—¶é•¿(åˆ†), å†…å®¹]
        // --- ï¼Œï¼Œï¼Œï¼Œ çš„æ•°æ® (æé™è¿åŠ¨ + æŠ€èƒ½å­¦ä¹ ) ---
        ["11-01", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 74, "ç¯®çƒè¿åŠ¨"],
        ["11-02", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 548, "çˆ¬å¤§å—å±± (æé™æŒ‘æˆ˜)"],
        ["11-03", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 68, "ç¯®çƒè¿åŠ¨"],
        ["11-04", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 79, "ç¯®çƒè¿åŠ¨"],
        ["11-05", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 107, "ç¯®çƒè¿åŠ¨"],
        ["11-06", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 37, "ç¯®çƒè¿åŠ¨"],
        ["11-07", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 57, "éª‘è¡Œè¿åŠ¨"],
        ["11-08", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 223, "æ‹¿ä¸‹æ¢§æ¡å±±"],
        ["11-09", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 74, "ç¯®çƒè¿åŠ¨"],
        ["11-10", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 62, "ç¯®çƒè¿åŠ¨"],
        ["11-11", "ï¼Œï¼Œï¼Œï¼Œ", "è¿åŠ¨", 130, "ç¯®çƒè¿åŠ¨"],
        ["11-12", "ï¼Œï¼Œï¼Œï¼Œ", "å­¦ä¹ ", 30, "é˜…è¯»ç¬¬ä¸ƒå¤©"],
        ["11-15", "ï¼Œï¼Œï¼Œï¼Œ", "å­¦ä¹ ", 270, "å­¦ä¹ ps"],
        ["11-16", "ï¼Œï¼Œï¼Œï¼Œ", "å­¦ä¹ ", 189, "å­¦ä¹ ps"],

        // --- Nice çš„æ•°æ® (ç¯®çƒ + æ·±åº¦é˜…è¯») ---
        ["11-01", "Nice", "è¿åŠ¨", 50, "æ‰“ç¯®çƒèµ›"],
        ["11-02", "Nice", "è¿åŠ¨", 548, "å¾æœå¤§å—å±±"],
        ["11-03", "Nice", "å­¦ä¹ ", 60, "ç—…ç¢éš™ç¬”"],
        ["11-09", "Nice", "å­¦ä¹ ", 60, "ç—…éš™éšç¬”"],
        ["11-09", "Nice", "è¿åŠ¨", 74, "ç¯®çƒæ¯”èµ›"],
        ["11-10", "Nice", "è¿åŠ¨", 60, "ç¯®çƒæ¯”èµ›"],
        ["11-11", "Nice", "è¿åŠ¨", 60, "ç¯®çƒæ¯”èµ›ï¼ˆå°åŒºï¼‰"],
        ["11-16", "Nice", "å­¦ä¹ ", 30, "æ–‡åŒ–è‹¦æ—…ä¸¤ç« "],
        ["11-16", "Nice", "å­¦ä¹ ", 60, "æ–‡åŒ–è‹¦æ—…é˜…è¯»"],
        ["11-19", "Nice", "å­¦ä¹ ", 20, "å°åŒºæ•£æ­¥"],

        // --- ã€‚ çš„æ•°æ® (å¤œè¡Œè€… + æ»‘æ¿) ---
        ["11-02", "ã€‚", "è¿åŠ¨", 548, "å¾æœå¤§å—å±±"],
        ["11-03", "ã€‚", "å­¦ä¹ ", 60, "æ™šç†Ÿçš„äºº"],
        ["11-07", "ã€‚", "è¿åŠ¨", 120, "æ»‘æ¿è¿åŠ¨"],
        ["11-11", "ã€‚", "è¿åŠ¨", 79, "å¥èº«é”»ç‚¼"],
        ["11-11", "ã€‚", "è¿åŠ¨", 61, "å¥èº«é”»ç‚¼"],
        ["11-12", "ã€‚", "å­¦ä¹ ", 30, "æ™šç†Ÿçš„äºº"],
        ["11-13", "ã€‚", "è¿åŠ¨", 90, "å¥èº«è®­ç»ƒ"],
        ["11-19", "ã€‚", "è¿åŠ¨", 22, "é—²åº­ä¿¡æ­¥"],

        // --- å°¤å…‹ææ çš„æ•°æ® (é˜…è¯» + æ•£æ­¥) ---
        ["11-03", "å°¤å…‹ææ", "å­¦ä¹ ", 90, "å¾®ä¿¡é˜…è¯»"],
        ["11-04", "å°¤å…‹ææ", "å­¦ä¹ ", 10, "å­¦ä¹ è‹±è¯­å¤šé‚»å›½"],
        ["11-06", "å°¤å…‹ææ", "å­¦ä¹ ", 130, "å¾®ä¿¡é˜…è¯»"],
        ["11-07", "å°¤å…‹ææ", "è¿åŠ¨", 20, "æ¥¼ä¸‹æ•£æ­¥"],
        ["11-09", "å°¤å…‹ææ", "è¿åŠ¨", 30, "æ¥¼ä¸‹æ•£æ­¥"],
        ["11-09", "å°¤å…‹ææ", "è¿åŠ¨", 40, "å®¶é‡Œæ•£æ­¥"],
        ["11-09", "å°¤å…‹ææ", "å­¦ä¹ ", 52, "å¾®ä¿¡é˜…è¯»"],
        ["11-11", "å°¤å…‹ææ", "è¿åŠ¨", 26, "æ¥¼ä¸‹æ•£æ­¥"],
        ["11-11", "å°¤å…‹ææ", "è¿åŠ¨", 30, "å°åŒºæ¥¼ä¸‹æ•£æ­¥"],
        ["11-15", "å°¤å…‹ææ", "å­¦ä¹ ", 840, "å¾®ä¿¡é˜…è¯»ç¦æ ¼è¡Œä¸ºæ¨¡å‹"],
        ["11-18", "å°¤å…‹ææ", "å­¦ä¹ ", 90, "å¾®ä¿¡é˜…è¯»"],
        ["11-18", "å°¤å…‹ææ", "å­¦ä¹ ", 10, "å­¦è‹±è¯­å¤šé‚»å›½"],

        // --- wuxx çš„æ•°æ® (ç¢ç‰‡åŒ–å­¦ä¹  + å“²å­¦) ---
        ["11-04", "wuxx", "å­¦ä¹ ", 100, "é˜…è¯» 100mï¼Œè‹±è¯­ 5m"],
        ["11-04", "wuxx", "è¿åŠ¨", 20, "è¶³å¼“è®­ç»ƒ 20m"],
        ["11-10", "wuxx", "å­¦ä¹ ", 35, "é˜…è¯»30ï¼Œè‹±æ–‡5m"],
        ["11-10", "wuxx", "å­¦ä¹ ", 5, "è‹±æ–‡5m"], 
        ["11-10", "wuxx", "å­¦ä¹ ", 5, "è‹±æ–‡5m"], 
        ["11-10", "wuxx", "å­¦ä¹ ", 5, "è‹±æ–‡5m"], 
        ["11-10", "wuxx", "å­¦ä¹ ", 5, "è‹±æ–‡5m"], 
        ["11-10", "wuxx", "å­¦ä¹ ", 5, "è‹±æ–‡5m"], 
        ["11-13", "wuxx", "å­¦ä¹ ", 5, "è‹±è¯­5m"],
        ["11-13", "wuxx", "è¿åŠ¨", 30, "åº·å¤è®­ç»ƒ30m"],
        ["11-13", "wuxx", "å­¦ä¹ ", 5, "è‹±è¯­5m"],
        ["11-13", "wuxx", "è¿åŠ¨", 30, "åº·å¤è¿åŠ¨30m"],
        ["11-13", "wuxx", "å­¦ä¹ ", 30, "é˜…è¯»25mï¼Œè‹±è¯­5m"],
        ["11-13", "wuxx", "è¿åŠ¨", 30, "æ•£æ­¥1wæ­¥"],
        ["11-13", "wuxx", "å­¦ä¹ ", 5, "è‹±è¯­5m"],
        ["11-13", "wuxx", "å­¦ä¹ ", 88, "é˜…è¯» 83mï¼Œè‹±è¯­ 5m"],
        ["11-15", "wuxx", "å­¦ä¹ ", 30, "é˜…è¯» 20ï¼Œè‹±è¯­ 10"],
        ["11-15", "wuxx", "å­¦ä¹ ", 280, "é˜…è¯» 154mï¼ŒLLM çš„é™å™ªå­¦ä¹ "],
        ["11-16", "wuxx", "å­¦ä¹ ", 87, "å‰‘æ¡¥ä¸­å›½å² 77mï¼Œè‹±è¯­ 10m"],
        ["11-18", "wuxx", "å­¦ä¹ ", 21, "å‰‘æ¡¥ä¸­å›½å² 13mï¼Œè‹±æ–‡ 8m"],
        ["11-19", "wuxx", "å­¦ä¹ ", 42, "è¥¿æ–¹å“²å­¦å²é˜…è¯»"],
        ["11-19", "wuxx", "è¿åŠ¨", 43, "ç‘œä¼½ 29mï¼Œæ— æ°§ 14m"],
        ["11-19", "wuxx", "å­¦ä¹ ", 46, "è‹±æ–‡ 10mï¼Œè¥¿æ–¹å“²å­¦å² 36m"],
        ["11-21", "wuxx", "å­¦ä¹ ", 37, "è¥¿æ–¹å“²å­¦å²é˜…è¯» 25m"]
    ];

    // ç”¨æˆ·é…ç½®è¡¨
    const userProfiles = {
        "ï¼Œï¼Œï¼Œï¼Œ": { avatar: "ğŸ”ï¸", label: "æ½œèƒ½æ¢ç´¢å®¶", quote: "è¦ä¹ˆä¸åšï¼Œè¦ä¹ˆåšåˆ°æè‡´ã€‚548åˆ†é’Ÿçš„çˆ¬å±±æ˜¯ä½ æ„å¿—çš„ä¸°ç¢‘ã€‚" },
        "Nice": { avatar: "ğŸ€", label: "æ–‡æ­¦åŒå…¨", quote: "åŠ¨é™çš†å®œã€‚çƒåœºä¸Šçš„æ±—æ°´ä¸ã€Šæ–‡åŒ–è‹¦æ—…ã€‹çš„æ²‰æ€ï¼Œæ„æˆäº†å®Œæ•´çš„ä½ ã€‚" },
        "å°¤å…‹ææ": { avatar: "ğŸ“–", label: "çµé­‚æ¼«æ­¥è€…", quote: "åœ¨ä½™åçš„æ–‡å­—é‡Œæµæ³ªï¼Œåœ¨æ¥¼ä¸‹çš„è¡—é“æ•£æ­¥ï¼Œæ¾å¼›æ„Ÿæ˜¯ä½ çš„æ­¦å™¨ã€‚" },
        "wuxx": { avatar: "âš¡", label: "å¤åˆ©é­”æ³•å¸ˆ", quote: "5åˆ†é’Ÿçš„å¾®ä¹ æƒ¯ä¹Ÿèƒ½èšæ²™æˆå¡”ã€‚ä»å“²å­¦åˆ°LLMï¼Œä½ çš„æ±‚çŸ¥æ¬²æ²¡æœ‰è¾¹ç•Œã€‚" },
        "ã€‚": { avatar: "ğŸ›¹", label: "è‡ªç”±è¿½é£äºº", quote: "æ»‘æ¿ä¸æ·±å¤œã€‚ä½ çš„è‡ªå¾‹ä¸å¾ªè§„è¹ˆçŸ©ï¼Œè€Œæ˜¯å¯¹è‡ªç”±çš„æ— é™å‘å¾€ã€‚" }
    };

    // --- æ•°æ®å¤„ç†é€»è¾‘ ---
    let processedData = {};

    rawData.forEach(row => {
        const [date, user, type, duration, content] = row;
        if (!processedData[user]) {
            processedData[user] = {
                name: user,
                records: [],
                totalMin: 0,
                days: new Set(),
                types: {},
                maxDuration: 0,
                highlightContent: ""
            };
        }
        
        const u = processedData[user];
        u.records.push({ date, type, duration, content });
        u.totalMin += duration;
        u.days.add(date);
        u.types[type] = (u.types[type] || 0) + duration;
        
        // è®¡ç®—é«˜å…‰æ—¶åˆ»
        if (duration > u.maxDuration) {
            u.maxDuration = duration;
            u.highlightContent = content;
        }
    });

    // ========================================
    // 2. è§†å›¾é€»è¾‘
    // ========================================
    let currentUser = null;

    const router = {
        history: [],
        go(pageId) {
            const active = document.querySelector('.page.active');
            const next = document.getElementById(pageId);
            if (active) {
                active.classList.remove('active');
                this.history.push(active.id);
            }
            next.classList.add('active');
        },
        back() {
            if (this.history.length === 0) return;
            const prevId = this.history.pop();
            document.querySelector('.page.active').classList.remove('active');
            document.getElementById(prevId).classList.add('active');
        }
    };

    // --- åˆå§‹åŒ–ï¼šæ¸²æŸ“ç”¨æˆ·åˆ—è¡¨ ---
    function init() {
        const container = document.getElementById('userListContainer');
        Object.keys(processedData).forEach(key => {
            const profile = userProfiles[key] || { avatar: "ğŸ‘¤", label: "åšæŒè€…" };
            const data = processedData[key];
            
            const card = document.createElement('div');
            card.className = 'user-card';
            card.innerHTML = `
                <span class="u-avatar">${profile.avatar}</span>
                <div class="u-name">${key}</div>
                <span class="u-label">${profile.label}</span>
                <div style="font-size:12px; color:#666; margin-top:5px;">åšæŒ${data.days.size}å¤© / ${data.totalMin}åˆ†é’Ÿ</div>
            `;
            card.onclick = () => loadUser(key);
            container.appendChild(card);
        });
    }

    // --- åŠ è½½ç‰¹å®šç”¨æˆ·æ•°æ® ---
    function loadUser(username) {
        currentUser = processedData[username];
        const profile = userProfiles[username];

        // Page 3: ä»ªè¡¨ç›˜æ•°æ®
        document.getElementById('dashAvatar').innerText = profile.avatar;
        document.getElementById('dashName').innerText = username;
        document.getElementById('dashDays').innerText = currentUser.days.size;
        
        // ç®€å•çš„è¿æ‰“è®¡ç®— (Simplified)
        const streak = calculateStreak(Array.from(currentUser.days));
        document.getElementById('dashStreak').innerText = streak;

        // æ ¸å¿ƒé¢†åŸŸ
        const topType = Object.keys(currentUser.types).reduce((a, b) => currentUser.types[a] > currentUser.types[b] ? a : b);
        document.getElementById('dashType').innerText = topType;
        document.getElementById('dashQuote').innerText = profile.quote || "çœŸæ­£çš„æ”¹å˜ï¼Œæ€»æ˜¯æ‚„æ— å£°æ¯ã€‚";

        // åŠ¨ç”»æ•°å­—
        animateValue("dashTotalTime", 0, currentUser.totalMin, 1500);

        // Page 4: æ—¶é—´è½´æ¸²æŸ“
        renderTimeline(currentUser.records);

        // Page 5: æµ·æŠ¥æ•°æ®
        document.getElementById('posterAvatar').innerText = profile.avatar;
        document.getElementById('posterName').innerText = username;
        document.getElementById('posterKeyword').innerText = profile.label;
        document.getElementById('posterDesc').innerText = profile.quote + `\n\nåœ¨è¿‡å»çš„30å¤©é‡Œï¼Œä½ ç•™ä¸‹äº† ${currentUser.totalMin} åˆ†é’Ÿçš„å°è®°ã€‚`;
        document.getElementById('posterTime').innerText = Math.round(currentUser.totalMin / 60 * 10) / 10;
        document.getElementById('posterHighlight').innerText = currentUser.maxDuration + "m";

        router.go('p3');
    }

    // --- æ¸²æŸ“æ—¶é—´è½´ ---
    function renderTimeline(records) {
        const container = document.getElementById('timelineList');
        container.innerHTML = '';
        
        // æŒ‰æ—¥æœŸæ’åº
        records.sort((a, b) => new Date("2025-" + a.date) - new Date("2025-" + b.date));

        records.forEach((rec, index) => {
            const div = document.createElement('div');
            div.className = 't-node';
            div.style.animationDelay = `${index * 0.05}s`;
            
            const isHigh = rec.duration > 100; // é«˜å…‰åˆ¤å®š
            const typeClass = rec.type === 'è¿åŠ¨' ? 'tag-sport' : 'tag-study';
            
            div.innerHTML = `
                <div class="t-date">${rec.date}</div>
                <div class="t-line-box">
                    <div class="t-line"></div>
                    <div class="t-dot" style="${isHigh ? 'background:var(--gold); box-shadow:0 0 10px var(--gold)' : ''}"></div>
                </div>
                <div class="t-content" style="${isHigh ? 'border:1px solid rgba(255, 214, 10, 0.3)' : ''}">
                    ${isHigh ? '<div class="badge-high">ğŸ‘‘</div>' : ''}
                    <span class="t-tag ${typeClass}">${rec.type}</span>
                    <span class="t-dur">${rec.duration}m</span>
                    <span class="t-text">${rec.content}</span>
                </div>
            `;
            container.appendChild(div);
        });
    }

    // --- è¾…åŠ©å‡½æ•°: è¿æ‰“è®¡ç®— ---
    function calculateStreak(dates) {
        // ç®€åŒ–ç‰ˆï¼šè¿™é‡Œä»…åšå±•ç¤ºï¼ŒçœŸå®é€»è¾‘éœ€å¤„ç†è·¨æœˆ
        // å‡è®¾æ•°æ®éƒ½åœ¨11æœˆ
        if (dates.length === 0) return 0;
        let days = dates.map(d => parseInt(d.split('-')[1])).sort((a, b) => a - b);
        let maxStreak = 1;
        let currentStreak = 1;
        for (let i = 1; i < days.length; i++) {
            if (days[i] === days[i-1] + 1) {
                currentStreak++;
            } else if (days[i] === days[i-1]) {
                continue; // åŒä¸€å¤©å¿½ç•¥
            } else {
                maxStreak = Math.max(maxStreak, currentStreak);
                currentStreak = 1;
            }
        }
        return Math.max(maxStreak, currentStreak);
    }

    // --- è¾…åŠ©å‡½æ•°: æ•°å­—æ»šåŠ¨åŠ¨ç”» ---
    function animateValue(id, start, end, duration) {
        const obj = document.getElementById(id);
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            obj.innerHTML = Math.floor(progress * (end - start) + start);
            if (progress < 1) {
                window.requestAnimationFrame(step);
            }
        };
        window.requestAnimationFrame(step);
    }

    // å¯åŠ¨
    init();

</script>
</body>
</html>